<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Welcome back, buddy!</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous">
</head>

<body>

<header id="home-header" th:insert="fragments/header :: header"></header>

<section class="container">
    <div class="px-4 py-5 px-md-5 text-center text-lg-start align-items-center justify-content-around">
        <div id="home-content" class="container">
            <!--title and description-->
            <div class="row-lg-1 mb-3 mb-lg-0">
                <h4 class="my-4 fw-bold ls-tight" th:text="${'Good to see you again, ' + user.getFirstName() + '!'}">
                    Hi! <br/>
                </h4>
            </div>
            <div id="home-image">
                <img src="../static/images/home.png"
                     href="/login"
                     th:src="@{images/home.png}"
                     th:href="@{/login}"
                     class="img-fluid"/>
            </div>
            <div class="row gx-lg-5 d-flex justify-content-center align-items-center">

                <div class="row-lg-6 mb-5 mb-lg-0">
                    <h4 class="my-4" th:text="${'Your current balance: ' + #strings.replace(#numbers.formatCurrency(user.getBalance()), ',00', '')}"> Your current balance</h4>
                    <!--most recent-->
                    <div class="row">
                        <!-- most recent connection-->
                        <div class="d-flex flex-column justify-content-center " id="last-connection">
                            <div id="last-connection-title">
                                <h5 style="color: #74d36a">Most recent connection </h5>
                            </div>
                            <div id="last-connection-table" class="table table-striped col-10 justify-content-between mx-auto">
                                <p th:if="${mostRecentConnection == null}">No connections. <a href="/add-connection" th:href="@{/add-connection}" style="color: #f48725">Add a connection</a>
                                </p>
                                <p class="text-center"
                                   th:text="${(mostRecentConnection.initializer.getEmail() == user.getEmail()) ?
                               mostRecentConnection.receiver.getFirstname() + ', added the ' + mostRecentConnection.getStartingDate()
                               : mostRecentConnection.initializer.getFirstname() + ', added the ' + mostRecentConnection.getStartingDate()}">Haley, added the 03-10-2022 16:18
                                </p>
                            </div>
                        </div>
                        <!-- most recent transaction-->
                        <div class="col d-flex flex-column justify-content-center" id="last-transaction">
                            <div id="last-transaction-title">
                                <h5 style="color: #74d36a">Most recent transaction </h5>
                            </div>
                            <div id="last-transaction-table" class="table table-striped col-10 justify-content-between mx-auto">
                                <p th:if="${mostRecentTransaction == null}">No transactions. <a href="/transfer" th:href="@{/transfer}" style="color: #f48725">Add transaction</a>
                                </p>
                                <p class="text-center"
                                   th:text="${#strings.replace(#numbers.formatCurrency(mostRecentTransaction.amount), ',00', '')}
                               + ${(mostRecentTransaction.issuer.getEmail() == user.getEmail()) ?
                               ' to ' + mostRecentTransaction.payee.getFirstname() :
                               ' from ' + mostRecentTransaction.issuer.getFirstname()}
                                   ">10.55â‚¬ to Hayley
                                </p>
                            </div>
                        </div>
                    </div>
                    <!-- quick access buttons -->
                    <div class="row justify-content-center align-items-center mx-auto">
                        <button type="submit" class="btn btn-primary col m-4"
                                href="/transfer"
                                th:href="@{/transfer}">
                            Transfer
                        </button>
                        <button type="button" class="btn btn-primary col m-4"
                                href="/profile"
                                th:href="@{/profile}">
                            Profile
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<footer>
    <div th:replace="fragments/footer :: footer" class="text-center">Pay My Buddy | 2022 | &copy; <a href="https://github.com/ernhollam/PayMyBuddy" target="_blank">ernhollam</a></div>
</footer>
</body>

</html>